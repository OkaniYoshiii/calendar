{{ block "main" . }}
    <div>
        <h1>Calendrier partage de la mascotte</h1>
        <table>
            <thead>
                <tr>
                    <th>Nom</th>
                    <th>Surnom</th>
                    <th>Date d'anniversaire</th>
                </tr>
            </thead>
            <tbody>
                {{ range $index, $child := $.Childs }}
                    <tr>
                        <td>{{ $child.Name }}</td>
                        <td>
                            {{ if $child.Nickname.Valid }}
                                {{ $child.Nickname}}
                            {{ else }}
                                Aucun
                            {{ end }}
                        </td>
                        <td>{{ timef $child.Birthday "DateOnly" }}</td>
                    </tr>
                {{ end }}
            </tbody>
        </table>

        <div style="display: grid; grid-template-columns: repeat(4, 1fr); column-gap: 2rem;">
            {{ range $i, $month := $.Calendar.Months }}
                <div style="margin-bottom: 32px;">
                    <p>{{ $month.Label }}</p>
                    <div style="display: grid; grid-template-columns: repeat(7, 1fr);">
                        <p>Lun</p>
                        <p>Mar</p>
                        <p>Mer</p>
                        <p>Jeu</p>
                        <p>Ven</p>
                        <p>Sam</p>
                        <p>Dim</p>
                    </div>
                    {{ range $week := $month.Weeks }}
                        <div style="display: grid; grid-template-columns: repeat(7, 1fr);">
                            {{ range $day := $week.Days}}
                                <div>
                                    {{ $childs := $day.Payload.Childs }}
                                    {{ if gt (len $childs) 0  }}
                                        <button data-dialog-id="dialog_{{ $day.Time.String }}" style="background-color: blue; {{ if $day.IsSame $.Now }} background-color: red; {{ end }}">{{ $day.Value }}</button>
                                        <dialog id="dialog_{{ $day.Time.String }}">
                                            <div>
                                                {{ range $child := $childs }}
                                                    <p>Anniversaire de : {{ $child.Name }}</p>
                                                {{ end }}
                                            </div>
                                        </dialog>
                                    {{ else }}
                                        <p style="{{ if $day.IsSame $.Now }} background-color: red; {{ end }}">{{ $day.Value }}</p>
                                    {{ end }}
                                </div>
                            {{ end }}
                        </div>
                    {{ end }}
                </div>
            {{ end }}
        </div>
    </div>

    <script>
      const buttons = document.querySelectorAll('[data-dialog-id]');

      buttons.forEach((button) => {
        const id = button.getAttribute('data-dialog-id');
        const dialog = document.getElementById(id);

        button.addEventListener('click', () => {
          dialog.showModal();
        })
      })
    </script>
{{ end }}
